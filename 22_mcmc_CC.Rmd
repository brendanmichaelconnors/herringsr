# Central Coast diagnostics

This section contains Markov chain Monte Carlo (MCMC) diagnostics for the
Central Coast major stock assessment region SCA model.
The MCMC run had chain length `r mcmc_length`
with a sample taken every `r f(mcmc_samp_freq)`^th^ iteration.
The first `r f(mcmc_burnin)` samples were discarded (burn-in), 
leaving `r f(mcmc_num_samples-mcmc_burnin)` samples for the posteriors.
These diagnostics will not be included in the final Science Response.

(ref:cc-priors-posts-figure) Prior probability distributions (lines) with
comparative posterior histograms (bars) used in the Central Coast major stock assessment region.
The dotted red lines are the maximum posterior density estimates.
See Table \@ref(tab:hg-parameter-est-table) for description.

```{r cc-priors-posts-figure, fig.cap = "(ref:cc-priors-posts-figure)"}
model_ind <- match(en2fr("CC", french), major_regions_short)
make.priors.posts.plot(major_models[[model_ind]],
                       priors.only = FALSE)
```

(ref:cc-traces-figure) Trace plots for Markov chain Monte Carlo output of
estimated parameters for the Central Coast major stock assessment region.
See Table \@ref(tab:hg-parameter-est-table) for description.
In addition, $B_0$ is unfished biomass,
$\mli{SB}_0$ is unfished spawning biomass,
$\mli{SSB}$ is spawning biomass,
$\hat{a}_k$ is selectivity-at-age-50%, and
$\hat{\gamma}_k$ is selectivity standard deviation-at-50%.
Subscripts on $\hat{a}$ and $\hat{\gamma}$ represent gears as follows:
$k=1$ is other fisheries, $k=2$ is roe seine, $k=3$ is roe gillnet.

```{r cc-traces-figure, fig.asp=1, fig.cap="(ref:cc-traces-figure)"}
make.traces.plot(major_models[[model_ind]],
                 axis.lab.freq = 200)
```

ref:cc-autocor-figure) Auto-correlation plots for Markov chain Monte Carlo output of
estimated parameters for the Central Coast major stock assessment region.
See Table \@ref(tab:hg-parameter-est-table) and
Figure \@ref(fig:cc-traces-figure) for description.

```{r cc-autocor-figure, fig.asp=1, fig.cap = "(ref:cc-autocor-figure)"}
make.autocor.plot(major_models[[model_ind]])
```

(ref:cc-pairs-figure) Pairs plots for Markov chain Monte Carlo output of
estimated parameters for the Central Coast major stock assessment region.
See Table \@ref(tab:hg-parameter-est-table) and
Figure \@ref(fig:cc-traces-figure) for description.

```{r cc-pairs-figure, fig.asp=1, fig.cap = "(ref:cc-pairs-figure)"}
make.pairs.plot(major_models[[model_ind]])
```

(ref:cc-biomass-retro-figure) Maximum posterior density of spawning biomass
with retrospectives for the Central Coast major stock assessment region.

```{r cc-biomass-retro-figure, fig.cap = "(ref:cc-biomass-retro-figure)"}
biomass.plot.mpd(major_models[[model_ind]],
                 xlim = c(1972, assess_yr))
```

(ref:decision-table-cc) `r paste0("Projected spawning biomass for ", assess_yr + 1, " compared to harvest rate and TAC for the Central Coast region, rows 1-4 in Table \\@ref(tab:decision-table-cc). Red horizontal and vertical lines show median harvest rate, TAC, and projected $\\mli{SB}_t$; mean statistics shown with green lines.")`
```{r hcr-cc, fig.cap = "(ref:decision-table-cc)"}
region <- "CC"
probs <- confidence_vals
cowplot::plot_grid(plot_hcr(mp.lst.cc[[1]][[1]],
                            sbt.cc,
                            mp = mp.cc[1,]$label,
                            region = region,
                            probs = probs),
                   plot_hcr(mp.lst.cc[[1]][[2]],
                            sbt.cc,
                            mp = mp.cc[2,]$label,
                            region = region,
                            probs = probs),
                   plot_hcr(mp.lst.cc[[1]][[3]],
                            sbt.cc,
                            mp = mp.cc[3,]$label,
                            region = region,
                            probs = probs,
                            show.x.axes = TRUE),
                   plot_hcr(mp.lst.cc[[1]][[4]],
                            sbt.cc,
                            mp = mp.cc[4,]$label,
                            region = region,
                            probs = probs,
                            show.x.axes = TRUE),
                   nrow = 2,
                   ncol = 2,
                   align = "hv",
                   axis = "tblr")
```

(ref:decision-table-cc-2) `r paste0("Projected spawning biomass for ", assess_yr + 1, " compared to harvest rate and TAC for the Central Coast region, rows 5-8 in Table \\@ref(tab:decision-table-cc). Red horizontal and vertical lines show median harvest rate, TAC, and projected $\\mli{SB}_t$; mean statistics shown with green lines.")`
```{r hcr-cc-2, fig.cap = "(ref:decision-table-cc-2)"}
region <- "CC"
probs <- confidence_vals 
cowplot::plot_grid(plot_hcr(mp.lst.cc[[1]][[5]],
                            sbt.cc,
                            mp = mp.cc[5,]$label,
                            region = region,
                            probs = probs),
                   plot_hcr(mp.lst.cc[[1]][[6]],
                            sbt.cc,
                            mp = mp.cc[6,]$label,
                            region = region,
                            probs = probs),
                   plot_hcr(mp.lst.cc[[1]][[7]],
                            sbt.cc,
                            mp = mp.cc[7,]$label,
                            region = region,
                            probs = probs,
                            show.x.axes = TRUE),
                   plot_hcr(mp.lst.cc[[1]][[8]],
                            sbt.cc,
                            mp = mp.cc[8,]$label,
                            region = region,
                            probs = probs,
                            show.x.axes = TRUE),
                   nrow = 2,
                   ncol = 2,
                   align = c("v", "h"))
```

(ref:decision-table-cc-3) `r paste0("Projected spawning biomass for ", assess_yr + 1, " compared to harvest rate and TAC for the Central Coast region, rows 9-10 in Table \\@ref(tab:decision-table-cc). Red horizontal and vertical lines show median harvest rate, TAC, and projected $\\mli{SB}_t$; mean statistics shown with green lines.")`
```{r hcr-cc-3, fig.cap = "(ref:decision-table-cc-3)"}
region <- "CC"
probs <- confidence_vals 
cowplot::plot_grid(plot_hcr(mp.lst.cc[[1]][[9]],
                            sbt.cc,
                            mp = mp.cc[9,]$label,
                            region = region,
                            probs = probs),
                   plot_hcr(mp.lst.cc[[1]][[10]],
                            sbt.cc,
                            mp = mp.cc[10,]$label,
                            region = region,
                            probs = probs,
                            show.x.axes = TRUE),
                   nrow = 2,
                   ncol = 1,
                   align = c("v", "h"))
```
