# Tables

(ref:data-input-cap) `r paste0("Input data for the ", assess_yr," Pacific Herring stock assessment. The spawn index has two distinct periods defined by the dominant survey method: surface surveys (", major_start_yr, " to ", new_surv_yr - 1, "), and dive surveys (", new_surv_yr, " to ", major_end_yr, "). The 'spawn index' represents the raw survey data only, and is not scaled by the spawn survey scaling parameter $q$.")`

(ref:data-input-cap-french) `r paste0("Données d’entrée pour l’évaluation des stocks de hareng du Pacifique de ", assess_yr, ". L’indice du frai comporte deux périodes distinctes définies par la méthode de relevé dominante : relevés en surface (de ", major_start_yr, " à ", new_surv_yr - 1, ") et relevés de plongée (de ", new_surv_yr, " à ", major_end_yr, "). L’indice du frai représente uniquement les données brutes de relevé et n’est pas mis à l’échelle à l’aide du paramètre de mise à l’échelle du relevé du frai $q$.")`

```{r data-input}
input_data_table(inp_catch,
                 cap = ifelse(french, "(ref:data-input-cap-french)", "(ref:data-input-cap)"),
                 french)
```

(ref:annual-catch-cap) Total landed catch in tonnes of Pacific Herring in the major stock assessment areas. Legend: Haida Gwaii (HG), Prince Rupert District (PRD), Central Coast (CC), Strait of Georgia (SoG), and West Coast of Vancouver Island (WCVI). Note: 'WP' indicates that data are withheld due to privacy concerns.

(ref:annual-catch-cap-french) Total des prises débarquées en tonnes de hareng du Pacifique dans les principales zones d’évaluation des stocks. Légende : Haida Gwaii (HG), le district de Prince Rupert (DPR), la côte centrale (CC), le détroit de Georgie (DG) et la côte ouest de l’île de Vancouver (COIV). Remarque : « DT » indique que les données ne sont pas divulguées pour des raisons de confidentialité.

```{r annual-catch}
total_landed_catch_table(major_catch_short,
                         by_vec = major_regions_short,
                         first_yr = assess_yr - 9,
                         cap = ifelse(french, "(ref:annual-catch-cap-french)", "(ref:annual-catch-cap)"),
                         french)
```

(ref:annual-sok-catch-cap) Total spawn-on-kelp harvest in pounds of Pacific Herring in the major stock assessment areas. Legend: Haida Gwaii (HG), Prince Rupert District (PRD), Central Coast (CC), Strait of Georgia (SoG), and West Coast of Vancouver Island (WCVI). Note: 'WP' indicates that data are withheld due to privacy concerns.

(ref:annual-sok-catch-cap-french) Récolte totale d’oeufs sur varech en livres de hareng du Pacifique dans les principales zones d’évaluation des stocks. Légende : Haida Gwaii (HG), le district de Prince Rupert (DPR), la côte centrale (CC), le détroit de Georgie (DG) et la côte ouest de l’île de Vancouver (COIV). Remarque : « DT » indique que les données ne sont pas divulguées pour des raisons de confidentialité.

```{r annual-sok-catch}
sok_harvest_table(sok,
                  by_vec = major_regions_short,
                  first_yr = assess_yr - 9,
                  cap = ifelse(french, "(ref:annual-sok-catch-cap-french)", "(ref:annual-sok-catch-cap)"),
                  french)
```

(ref:spawn-index-hg-cap) Spawn index in tonnes, and proportion of the spawn index by Group for Pacific Herring in the Haida Gwaii major stock assessment region. The spawn index is the annual total for the earliest year indicated in the 'Years' column. Proportions indicate the proportion by year, or mean proportion over years, where year(s) are specifed in the ‘Years’ column. The 'spawn index' represents the raw survey data only, and is not scaled by the spawn survey scaling parameter $q$. Legend: 'Cumshewa' is Section 023; 'Juan Perez/Skincuttle' is Sections 021 \& 025; 'Louscoone' is Section 006; and 'Selwyn' is Section 024.

(ref:spawn-index-hg-cap-french) Indice du frai en tonnes et proportion de l’indice du frai par groupe pour le hareng du Pacifique dans la principale région d’évaluation des stocks de Haida Gwaii. L’indice du frai est le total annuel pour la première année indiquée dans la colonne « Années ». Les proportions indiquent la proportion par année, ou la proportion moyenne sur plusieurs années, lorsque l’année ou les années sont indiquées dans la colonne « Années ». L’indice du frai représente uniquement les données brutes de relevé et n’est pas mis à l’échelle à l’aide du paramètre de mise à l’échelle du relevé du frai $q$.

```{r spawn-index-hg}
spawn_index_by_area_table(ps[[en2fr("HG", french)]],
                          cap = ifelse(french, "(ref:spawn-index-hg-cap-french)", "(ref:spawn-index-hg-cap)"),
                          french)
```

(ref:spawn-index-pr-cap) Spawn index in tonnes, and proportion of the spawn index by Statistical Area for Pacific Herring in the Prince Rupert District major stock assessment region. See Table \@ref(tab:spawn-index-hg) for description.

(ref:spawn-index-pr-cap-french) Indice du frai en tonnes et proportion de l’indice du frai par zone statistique pour le hareng du Pacifique dans la principale région d’évaluation des stocks du district de Prince Rupert. Voir le tableau \@ref(tab:spawn-index-hg) pour la description.

```{r spawn-index-prd}
spawn_index_by_area_table(ps[[en2fr("PRD", french)]], 
                          cap = ifelse(french, "(ref:spawn-index-pr-cap-french)", "(ref:spawn-index-pr-cap)"),
                          translate = french)
```

(ref:spawn-index-cc-cap) Spawn index in tonnes, and proportion of the spawn index by Statistical Area for Pacific Herring in the Central Coast major stock assessment region. See Table \@ref(tab:spawn-index-hg) for description.

(ref:spawn-index-cc-cap-french) Indice du frai en tonnes et proportion de l’indice du frai par zone statistique pour le hareng du Pacifique dans la principale région d’évaluation des stocks de la côte centrale. Voir le tableau \@ref(tab:spawn-index-hg) pour la description.

```{r spawn-index-cc}
spawn_index_by_area_table(ps[[en2fr("CC", french)]],
                          cap = ifelse(french, "(ref:spawn-index-cc-cap-french)", "(ref:spawn-index-cc-cap)"),
                          translate = french)
```

(ref:spawn-index-sog-cap) Spawn index in tonnes (t), and proportion of the spawn index by Group for Pacific Herring in the Strait of Georgia major stock assessment region. Legend: '14\&17' is Statistical Areas 14 and 17 (excluding Section 173); 'ESoG' is eastern Strait of Georgia; 'Lazo' is above Cape Lazo; and 'SDodd' is South of Dodd Narrows. See Table \@ref(tab:spawn-index-hg) for description.

(ref:spawn-index-sog-cap-french) Indice du frai en tonnes (t) et proportion de l’indice du frai par groupe pour le hareng du Pacifique dans la principale région d’évaluation des stocks du détroit de Georgie. Légende : « 14 et 17 » fait référence aux zones statistiques 14 et 17 (à l’exclusion de la section 173); « EDG » fait référence à l’est du détroit de Géorgie; « Lazo » fait référence au-dessus du cap Lazo; et « SDodd » fait référence au sud du passage Dodd. Voir le tableau \@ref(tab:spawn-index-hg) pour la description.

```{r spawn-index-sog}
spawn_index_by_area_table(ps[[en2fr("SoG", french)]],
                          cap = ifelse(french, "(ref:spawn-index-sog-cap-french)", "(ref:spawn-index-sog-cap)"),
                          translate = french)
```

(ref:spawn-index-wcvi-cap) Spawn index in tonnes (t), and proportion of the spawn index by Statistical Area for Pacific Herring in the West Coast of Vancouver Island major stock assessment region. See Table \@ref(tab:spawn-index-hg) for description.

(ref:spawn-index-wcvi-cap-french) Indice du frai en tonnes (t) et proportion de l’indice du frai par zone statistique pour le hareng du Pacifique dans la principale région d’évaluation des stocks de la côte ouest de l’île de Vancouver. Voir le tableau \@ref(tab:spawn-index-hg) pour la description.

```{r spawn-index-wcvi}
spawn_index_by_area_table(ps[[en2fr("WCVI", french)]],
                          cap = ifelse(french, "(ref:spawn-index-wcvi-cap-french)", "(ref:spawn-index-wcvi-cap)"),
                          translate = french)
```

(ref:ref-points-hg-cap) Posterior (5\textsuperscript{th} percentile, Median, and  95\textsuperscript{th} percentile) estimates of proposed reference points for the Haida Gwaii model. $\mli{SB}_{2019}$ represents prefishery spawning biomass, and all biomass numbers are in thousands of tonnes. Probability of $\mli{SB}_{2019} < 0.3\mli{SB}_0$ is based on zero catch.

(ref:ref-points-hg-cap-french) Estimations a posteriori (5\textsuperscript{e} percentile, médiane et 95\textsuperscript{e} percentile) des points de référence proposés pour le modèle de Haida Gwaii. La $\mli{BSR}_{2019}$ représente la biomasse reproductrice avant la pêche, et tous les chiffres indiqués pour la biomasse sont exprimés en milliers de tonnes. La probabilité de la $\mli{BSR}_{2019} < 0,3\mli{BSR}_0$ est fondée sur une prise nulle.

```{r ref-points-hg, results = 'asis', echo = FALSE}
model_ind <- match(en2fr("HG", french), major_regions_short)
make.ref.points.table(major_models[[model_ind]],
                      xcaption = ifelse(french, "(ref:ref-points-hg-cap-french)", "(ref:ref-points-hg-cap)"),
                      xlabel = "tab:ref-points-hg",
                      font.size = 11,
                      space.size = 12,
                      placement = "H",
                      translate = french)
```

(ref:ref-points-prd-cap) Posterior (5\textsuperscript{th} percentile, Median, and 95\textsuperscript{th} percentile) estimates of proposed reference points for the Prince Rupert District model. See Table \@ref(tab:ref-points-hg) for description.

(ref:ref-points-prd-cap-french) Estimations a posteriori (5\textsuperscript{e} percentile, médiane et 95\textsuperscript{e} percentile) des points de référence proposés pour le modèle du district de Prince Rupert. Voir le tableau \@ref(tab:ref-points-hg) pour la description.

```{r ref-points-prd, results = 'asis', echo = FALSE}
model_ind <- match(en2fr("PRD", french), major_regions_short)
make.ref.points.table(major_models[[model_ind]],
                      xcaption = ifelse(french, "(ref:ref-points-prd-cap-french)","(ref:ref-points-prd-cap)"),
                      xlabel = "tab:ref-points-prd",
                      font.size = 11,
                      space.size = 12,
                      placement = "H",
                      translate = french)
```

(ref:ref-points-cc-cap) Posterior (5\textsuperscript{th} percentile, Median, and 95\textsuperscript{th} percentile) estimates of proposed reference points for the Central Coast model. See Table \@ref(tab:ref-points-hg) for description.

(ref:ref-points-cc-cap-french) Estimations a posteriori (5\textsuperscript{e} percentile, médiane et 95\textsuperscript{e} percentile) des points de référence proposés pour le modèle de la côte centrale. Voir le tableau \@ref(tab:ref-points-hg) pour la description.

```{r ref-points-cc, results = 'asis', echo = FALSE}
model_ind <- match(en2fr("CC", french), major_regions_short)
make.ref.points.table(major_models[[model_ind]],
                      xcaption = ifelse(french, "(ref:ref-points-cc-cap-french)","(ref:ref-points-cc-cap)"),
                      xlabel = "tab:ref-points-cc",
                      font.size = 11,
                      space.size = 12,
                      placement = "H",
                      translate = french)
```

(ref:ref-points-sog-cap) Posterior (5\textsuperscript{th} percentile, Median, and 95\textsuperscript{th} percentile) estimates of proposed reference points for the Strait of Georgia model. See Table \@ref(tab:ref-points-hg) for description.

(ref:ref-points-sog-cap-french) Estimations a posteriori (5\textsuperscript{e} percentile, médiane et 95\textsuperscript{e} percentile) des points de référence proposés pour le modèle du détroit de Georgie. Voir le tableau \@ref(tab:ref-points-hg) pour la description.

```{r ref-points-sog, results = 'asis', echo = FALSE}
cap <- paste0("Posterior (5\\textsuperscript{th} percentile, Median, and ",
              "95\\textsuperscript{th} percentile) estimates of proposed reference ",
              "points for the Strait of Georgia model. See Table \\\\@ref(tab:ref-points-hg) for description.")
model_ind <- match(en2fr("SoG", french), major_regions_short)
make.ref.points.table(major_models[[model_ind]],
                      xcaption = ifelse(french, "(ref:ref-points-sog-cap-french)","(ref:ref-points-sog-cap)"),
                      xlabel = "tab:ref-points-sog",
                      font.size = 11,
                      space.size = 12,
                      placement = "H",
                      translate = french)
```

(ref:ref-points-wcvi-cap) Posterior (5\textsuperscript{th} percentile, Median, and 95\textsuperscript{th} percentile) estimates of proposed reference points for the West Coast Vancouver Island model. See Table \@ref(tab:ref-points-hg) for description.

(ref:ref-points-wcvi-cap-french) Estimations a posteriori (5\textsuperscript{e} percentile, médiane et 95\textsuperscript{e} percentile) des points de référence proposés pour le modèle de la côte ouest de l’île de Vancouver. Voir le tableau \@ref(tab:ref-points-hg) pour la description.

```{r ref-points-wcvi, results = 'asis', echo = FALSE}
cap <- paste0("Posterior (5\\textsuperscript{th} percentile, Median, and ",
              "95\\textsuperscript{th} percentile) estimates of proposed reference ",
              "points for the West Coast Vancouver Island model. See Table \\\\@ref(tab:ref-points-hg) for description.")
model_ind <- match(en2fr("WCVI", french), major_regions_short)
make.ref.points.table(major_models[[model_ind]],
                      xcaption = ifelse(french, "(ref:ref-points-wcvi-cap-french)","(ref:ref-points-wcvi-cap)"),
                      xlabel = "tab:ref-points-wcvi",
                      font.size = 11,
                      space.size = 12,
                      placement = "H",
                      translate = french)
```

```{r decision-table-hg, results = 'asis', echo = FALSE}
# cap <- "Probabilistic decision table for the Haida Gwaii AM2 model."
#
# model_ind <- match(en2fr("HG", french), major_regions_short)
# make.decision.table(major_models[[model_ind]],
#                     xcaption = cap,
#                     xlabel = "tab:decision-table-hg",
#                     font.size = 11,
#                     space.size = 12,
#                     placement = "H")
#
```

(ref:decision-table-prd-cap) Probabilistic decision table for the Prince Rupert District AM2 model.

(ref:decision-table-prd-cap-french) Tableau de décision probabilistes pour le district de Prince Rupert, modèle AM2.

```{r decision-table-prd, results = 'asis', echo = FALSE}
# model_ind <- match(en2fr("PRD", french), major_regions_short)
# make.decision.table(major_models[[model_ind]],
#                     xcaption = ifelse(french, "(ref:decision-table-prd-cap-french)", "(ref:decision-table-prd-cap)"),
#                     xlabel = "tab:decision-table-prd",
#                     font.size = 11,
#                     space.size = 12,
#                     placement = "H")
prd_mp <- read_csv("data/mp-prd.csv") %>% 
  as_tibble() %>% 
  arrange(desc(obj1), desc(obj2))
decision_tables_mp(prd_mp,
                   xcaption = ifelse(french, "(ref:decision-table-prd-cap-french)", "(ref:decision-table-prd-cap)"),
                   xlabel = "tab:decision-table-prd",
                   font.size = 7,
                   space.size = 10,
                   placement = "H",
                   last_col_header = paste0(assess_yr + 1, " TAC"),
                   perc_dec_pts = 0,
                   dec_pts = 2,
                   col_align = "ccc|c|c|c|c|c|c",
                   translate = french)
```

(ref:decision-table-cc-cap) Probabilistic decision table for the Central Coast AM2 model.

(ref:decision-table-cc-cap-french) Tableau de décision probabilistes pour la côte centrale, modèle AM2.

```{r decision-table-cc, results = 'asis', echo = FALSE}
# model_ind <- match(en2fr("CC", french), major_regions_short)
# make.decision.table(major_models[[model_ind]],
#                     xcaption = ifelse(french, "(ref:decision-table-cc-cap-french)", "(ref:decision-table-cc-cap)"),
#                     xlabel = "tab:decision-table-cc",
#                     font.size = 11,
#                     space.size = 12,
#                     placement = "H")
cc_mp <- read_csv("data/mp-cc.csv") %>% 
  as_tibble() %>% 
  arrange(desc(obj1), desc(obj2))
decision_tables_mp(cc_mp,
                   xcaption = ifelse(french, "(ref:decision-table-cc-cap-french)", "(ref:decision-table-cc-cap)"),
                   xlabel = "tab:decision-table-cc",
                   font.size = 7,
                   space.size = 10,
                   placement = "H",
                   last_col_header = paste0(assess_yr + 1, " TAC"),
                   perc_dec_pts = 0,
                   dec_pts = 2,
                   col_align = "ccc|c|c|c|c|c|c",
                   translate = french)
```

(ref:decision-table-sog-cap) Probabilistic decision table for the Strait of Georgia AM2 model.

(ref:decision-table-sog-cap-french) Tableau de décision probabilistes pour détroit de Georgie, modèle AM2.

```{r decision-table-sog, results = 'asis', echo = FALSE}
# cap <- "Probabilistic decision table for the Strait of Georgia AM2 model."
#
# model_ind <- match(en2fr("SoG", french), major_regions_short)
# make.decision.table(major_models[[model_ind]],
#                     xcaption = ifelse(french, "(ref:decision-table-sog-cap-french)", "(ref:decision-table-sog-cap)"),
#                     xlabel = "tab:decision-table-sog",
#                     font.size = 11,
#                     space.size = 12,
#                     placement = "H")
#
sog_mp <- read_csv("data/mp-sog.csv") %>% 
  as_tibble() %>% 
  arrange(desc(obj1), desc(obj2))
decision_tables_mp(sog_mp,
                   xcaption = ifelse(french, "(ref:decision-table-sog-cap-french)", "(ref:decision-table-sog-cap)"),
                   xlabel = "tab:decision-table-sog",
                   font.size = 7,
                   space.size = 10,
                   placement = "H",
                   last_col_header = paste0(assess_yr + 1, " TAC"),
                   perc_dec_pts = 0,
                   dec_pts = 2,
                   col_align = "ccc|c|c|c|c|c|c",
                   inc_mps = 9,
                   translate = french)
```

```{r decision-table-wcvi, results = 'asis', echo = FALSE}
# cap <- "Probabilistic decision table for the West Coast Vancouver Island AM2 model."
#
# model_ind <- match(en2fr("WCVI", french), major_regions_short)
# make.decision.table(major_models[[model_ind]],
#                     xcaption = cap,
#                     xlabel = "tab:decision-table-wcvi",
#                     font.size = 11,
#                     space.size = 12,
#                     placement = "H")
#
```

