# West Coast of Vancouver Island diagnostics

This section contains Markov chain Monte Carlo (MCMC) diagnostics for the
statistical catch-age model in the West Coast of Vancouver Island major stock assessment region.
The MCMC run had chain length `r mcmc_length`
with a sample taken every `r f(mcmc_samp_freq)`^th^ iteration.
The first `r f(mcmc_burnin)` samples were discarded (burn-in), 
leaving `r f(mcmc_num_samples-mcmc_burnin)` samples for posteriors.
These diagnostics will not be included in the final document.

(ref:wcvi-priors-posts-figure-cap) Prior probability distributions (lines) with
comparative posterior histograms (bars) used in the West Coast of Vancouver Island major stock assessment region.
The dotted red lines are maximum posterior density estimates.
See Table \@ref(tab:hg-parameter-est-table) for description.

```{r wcvi-priors-posts-figure, fig.cap = "(ref:wcvi-priors-posts-figure-cap)"}
model_ind <- match(en2fr("WCVI", french), major_regions_short)
make.priors.posts.plot(major_models[[model_ind]],
                       priors.only = FALSE)
```

(ref:wcvi-traces-figure-cap) Trace plots for Markov chain Monte Carlo output of
estimated parameters for the West Coast of Vancouver Island major stock assessment region.
See Table \@ref(tab:hg-parameter-est-table) for description.
In addition, $B_0$ is unfished biomass,
$\SB_0$ is unfished spawning biomass,
$\SB$ is spawning biomass,
$\hat{a}$ is selectivity-at-age-50%, and
$\hat{\gamma}$ is selectivity standard deviation-at-50%.
Subscripts on $\hat{a}$ and $\hat{\gamma}$ represent gears as follows:
1 is other fisheries, 2 is roe seine, and 3 is roe gillnet.

```{r wcvi-traces-figure, fig.asp=1, fig.cap="(ref:wcvi-traces-figure-cap)"}
make.traces.plot(major_models[[model_ind]],
                 axis.lab.freq = 200)
```

(ref:wcvi-autocor-figure-cap) Auto-correlation plots for Markov chain Monte Carlo output of
estimated parameters for the West Coast of Vancouver Island major stock assessment region.
See Table \@ref(tab:hg-parameter-est-table) and
Figure \@ref(fig:wcvi-traces-figure) for description.

```{r wcvi-autocor-figure, fig.asp=1, fig.cap = "(ref:wcvi-autocor-figure-cap)"}
make.autocor.plot(major_models[[model_ind]])
```

(ref:wcvi-pairs-figure-cap) Pairs plots for Markov chain Monte Carlo output of
estimated parameters for the West Coast of Vancouver Island major stock assessment region.
See Table \@ref(tab:hg-parameter-est-table) and
Figure \@ref(fig:wcvi-traces-figure) for description.

```{r wcvi-pairs-figure, fig.asp=1, fig.cap = "(ref:wcvi-pairs-figure-cap)"}
make.pairs.plot(major_models[[model_ind]])
```

(ref:wcvi-biomass-retro-figure-cap) Maximum posterior density spawning biomass
with retrospectives for the West Coast of Vancouver Island major stock assessment region.

```{r wcvi-biomass-retro-figure, fig.cap = "(ref:wcvi-biomass-retro-figure-cap)"}
biomass.plot.mpd(major_models[[model_ind]],
                 xlim = c(1972, assess_yr))
```
